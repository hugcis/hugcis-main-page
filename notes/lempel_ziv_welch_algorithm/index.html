<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1">
  <title>Lempel-Ziv-Welch algorithm - Hugo Cisneros</title>
  <meta property="og:title" content="Lempel-Ziv-Welch algorithm - Hugo Cisneros">
  <meta property="og:type" content="article">
  <meta property="og:image" content="/img/main.jpeg">
  <meta property="og:url" content="https://hugocisneros.com/notes/lempel_ziv_welch_algorithm/">
  <meta property="og:description" content="Notes about Lempel-Ziv-Welch algorithm">
  <meta name="Description" property="description" content="Notes about Lempel-Ziv-Welch algorithm">
  <link rel="me" href="https://twitter.com/@cisne_hug">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@cisne_hug">
  <meta name="twitter:creator" content="@cisne_hug">
  <link rel="me" href="https://scholar.social/@hugcis">
  <link rel="me" href="https://github.com/hugcis">
  <meta property="keywords" content="compression, complexity">
  <link rel="stylesheet" href="https://hugocisneros.com/css/style.min.css">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/svg+xml" href="/favicon.svg">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <meta name="theme-color" content="#ffffff">
  <link rel="webmention" href="https://webmention.io/hugocisneros.com/webmention">
  <link rel="pingback" href="https://webmention.io/hugocisneros.com/xmlrpc">
  <script>
  function updateMode(){localStorage.theme==="dark"||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}function toggleMode(){localStorage.theme==="dark"?localStorage.theme="light":localStorage.theme="dark",updateMode()}window.onload=updateMode();function toggleMenu(){let e=document.getElementById("navbar-default");e.classList.contains("hidden")?e.classList.remove("hidden"):e.classList.add("hidden")}
  </script>
</head>
<body>
  <header class="md:px-0 px-2">
    <nav>
      <div class="container flex flex-wrap justify-between items-center mx-auto">
        <div class="nav-main my-2.5">
          <a href="https://hugocisneros.com/" class="nav-title py-2.5 text-2xl text-zinc-600 dark:text-zinc-300 hover:border-b-0">Hugo Cisneros</a>
        </div><button type="button" onclick="toggleMenu()" class="inline-flex items-center p-2 ml-3 text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="navbar-default" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" aria-hidden="true" fill="currentcolor" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
        <path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4A1 1 0 013 5zm0 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button>
        <div class="hidden w-full md:block md:w-auto" id="navbar-default">
          <ul class="grid md:grid-flow-col items-center justify-between text-lg my-2.5">
            <li class="p-2.5 md:first:pl-0 md:border-none border-b list-none">
              <a class="text-zinc-600 dark:text-zinc-300 hover:border-b-0" href="/blog/">Blog</a>
            </li>
            <li class="p-2.5 md:first:pl-0 md:border-none border-b list-none">
              <a class="text-zinc-600 dark:text-zinc-300 hover:border-b-0" href="/notes/">Notes</a>
            </li>
            <li class="p-2.5 md:first:pl-0 md:border-none border-b list-none">
              <a class="text-zinc-600 dark:text-zinc-300 hover:border-b-0" href="/projects/">Projects</a>
            </li>
            <li class="p-2.5 md:first:pl-0 md:border-none border-b list-none">
              <a class="text-zinc-600 dark:text-zinc-300 hover:border-b-0" href="/resume/">Resume</a>
            </li>
            <li class="p-2.5 md:first:pl-0 md:border-none border-b list-none">
              <a class="text-zinc-600 dark:text-zinc-300 hover:border-b-0" href="/contact/">Contact</a>
            </li>
            <li class="h-7 pl-2.5 pr-0 list-none"><button type="button" onclick="toggleMode()" class="h-full"><img class="h-7 w-7 max-h-full mb-1.5 p-1.5 hidden dark:inline" id="dark-mode-button-img" src="https://hugocisneros.com/img/light_mode.svg"> <img class="h-7 w-7 max-h-full mb-1.5 p-1.5 inline dark:hidden" id="dark-mode-button-img" src="https://hugocisneros.com/img/dark_mode.svg"></button></li>
          </ul>
        </div>
      </div>
    </nav>
  </header>
  <main class="content h-card container mt-2 m-auto leading-loose md:px-0 px-2 z-0 Page(/notes/lempel_ziv_welch_algorithm.md)" role="main">
    <article class="article h-entry" itemprop="mainEntity" itemscope itemtype="http://schema.org/BlogPosting">
      <div class="bg-zinc-100 dark:bg-zinc-700 pb-2 pt-1 px-3 rounded-lg mb-4">
        <h1 class="article-title p-name" itemprop="name">Lempel-Ziv-Welch algorithm</h1>
        <div class="article-content e-content p-name" itemprop="articleBody">
          <dl>
            <dt>tags</dt>
            <dd>
              <a href="/notes/compression/">Compression</a>, <a href="/notes/complexity/">Complexity</a>
            </dd>
            <dt>papers</dt>
            <dd>
              (<a href="#lempelComplexityFiniteSequences1976"><cite itemprop="citation" itemscope itemid="doi:10.1109/TIT.1976.1055501">Lempel, Ziv 1976</cite></a>; <a href="#zivUniversalAlgorithmSequential1977"><cite itemprop="citation" itemscope itemid="doi:10.1109/TIT.1977.1055714">Ziv, Lempel 1977</cite></a>; <a href="#zivCompressionIndividualSequences1978"><cite itemprop="citation" itemscope itemid="doi:10.1109/TIT.1978.1055934">Ziv, Lempel 1978</cite></a>; <a href="#welchTechniqueHighPerformanceData1984"><cite itemprop="citation" itemscope itemid="doi:10.1109/MC.1984.1659158">Welch 1984</cite></a>; <a href="#storerDataCompressionTextual1982"><cite itemprop="citation" itemscope itemid="doi:10.1145/322344.322346">Storer, Szymanski 1982</cite></a>)
            </dd>
          </dl>
          <h2 id="context">Context</h2>
          <p>The LZW algorithm was originally designed as a complexity (“randomness”) metric for finite sequences (<a href="#lempelComplexityFiniteSequences1976"><cite itemprop="citation" itemscope itemid="doi:10.1109/TIT.1976.1055501">Lempel, Ziv 1976</cite></a>). It was then extended as a compression algorithm by the same authors to LZ77 (<a href="#zivUniversalAlgorithmSequential1977"><cite itemprop="citation" itemscope itemid="doi:10.1109/TIT.1977.1055714">Ziv, Lempel 1977</cite></a>) and LZ78 (<a href="#zivCompressionIndividualSequences1978"><cite itemprop="citation" itemscope itemid="doi:10.1109/TIT.1978.1055934">Ziv, Lempel 1978</cite></a>). Those last two are the basis of many well known and widely used compression utilities such as <code>GIF</code>, <code>compress</code> (LZW (<a href="#welchTechniqueHighPerformanceData1984"><cite itemprop="citation" itemscope itemid="doi:10.1109/MC.1984.1659158">Welch 1984</cite></a>) ) or <code>DEFLATE</code>, <code>gzip</code> (LZSS (<a href="#storerDataCompressionTextual1982"><cite itemprop="citation" itemscope itemid="doi:10.1145/322344.322346">Storer, Szymanski 1982</cite></a>)), etc.</p>
          <h2 id="description">Description</h2>
          <p>The base idea of these algorithms is to build a dictionary of words in the input sequence. A given sequence is scanned and an empty dictionary is initialized. Each new word is the shortest next word not in the dictionary. It is registered by using a previous word and adding a single digit in the form \((j, s_{last})\). This encoding allows a unique decoding of the original sequence. When encoding <strong>or</strong> decoding the string the same dictionary of words is built. For sequences with string repetitions, the length of each new word increases fast and the numbers of needed pairs to encode increases very slowly.</p>
          <p>Example implementation of the LZ algorithm in Python:</p>
          <div class="highlight">
            <pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="display:flex"><span><span style="color:#719e07">def</span> <span style="color:#268bd2">compress</span>(string):
</span></span><span style="display:flex"><span>    dic <span style="color:#719e07">=</span> {<span style="color:#2aa198">'0'</span>: <span style="color:#2aa198">0</span>, <span style="color:#2aa198">'1'</span>: <span style="color:#2aa198">1</span>}
</span></span><span style="display:flex"><span>    word <span style="color:#719e07">=</span> <span style="color:#2aa198">""</span>
</span></span><span style="display:flex"><span>    result <span style="color:#719e07">=</span> []
</span></span><span style="display:flex"><span>    <span style="color:#719e07">for</span> c <span style="color:#719e07">in</span> string:
</span></span><span style="display:flex"><span>        wc <span style="color:#719e07">=</span> word <span style="color:#719e07">+</span> c
</span></span><span style="display:flex"><span>        <span style="color:#719e07">if</span> wc <span style="color:#719e07">in</span> dic:
</span></span><span style="display:flex"><span>            word <span style="color:#719e07">=</span> wc
</span></span><span style="display:flex"><span>        <span style="color:#719e07">else</span>:
</span></span><span style="display:flex"><span>            result<span style="color:#719e07">.</span>append(dic[word])
</span></span><span style="display:flex"><span>            dic[wc] <span style="color:#719e07">=</span> <span style="color:#b58900">len</span>(dic)
</span></span><span style="display:flex"><span>            word <span style="color:#719e07">=</span> c
</span></span><span style="display:flex"><span>    <span style="color:#719e07">if</span> word:
</span></span><span style="display:flex"><span>        result<span style="color:#719e07">.</span>append(dic[word])
</span></span><span style="display:flex"><span>        <span style="color:#719e07">return</span> result
</span></span><span style="display:flex"><span>
</span></span><span style="display:flex"><span><span style="color:#b58900">print</span>(compress(<span style="color:#2aa198">"1101010101011101010001110100"</span>))
</span></span><span style="display:flex"><span><span style="color:#b58900">print</span>(compress(<span style="color:#2aa198">"1010101010101010101010101010"</span>))
</span></span></code></pre>
          </div>
          <p>Results:</p>
          <div class="highlight">
            <pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text"><span style="display:flex"><span>[1, 1, 0, 3, 5, 4, 4, 2, 7, 3, 0, 8, 6, 0]
</span></span><span style="display:flex"><span>[1, 0, 2, 4, 3, 6, 5, 8, 7, 6]
</span></span></code></pre>
          </div>
          <h2 id="bibliography">Bibliography</h2>
          <ol class="biblio-list pl-0">
            <li class="list-none my-4 mx-2"><span itemprop="citation" itemscope itemtype="https://schema.org/ScholarlyArticle" id="lempelComplexityFiniteSequences1976" itemid="doi:10.1109/TIT.1976.1055501"><span itemprop="author">A. Lempel, J. Ziv</span>. <time datetime="1976" itemprop="datePublished">January 1976</time>. "<span itemprop="name">On the Complexity of Finite Sequences</span>". <span itemprop="isPartOf" itemscope itemtype="https://schema.org/Periodical"><i itemprop="name">IEEE Transactions on Information Theory</i></span> 22 (1):75–81. <a itemprop="sameAs" href="https://doi.org/10.1109/TIT.1976.1055501">DOI</a>.</span></li>
            <li class="list-none my-4 mx-2"><span itemprop="citation" itemscope itemtype="https://schema.org/ScholarlyArticle" id="zivUniversalAlgorithmSequential1977" itemid="doi:10.1109/TIT.1977.1055714"><span itemprop="author">J. Ziv, A. Lempel</span>. <time datetime="1977" itemprop="datePublished">May 1977</time>. "<span itemprop="name">A Universal Algorithm for Sequential Data Compression</span>". <span itemprop="isPartOf" itemscope itemtype="https://schema.org/Periodical"><i itemprop="name">IEEE Transactions on Information Theory</i></span> 23 (3):337–43. <a itemprop="sameAs" href="https://doi.org/10.1109/TIT.1977.1055714">DOI</a>.</span></li>
            <li class="list-none my-4 mx-2"><span itemprop="citation" itemscope itemtype="https://schema.org/ScholarlyArticle" id="zivCompressionIndividualSequences1978" itemid="doi:10.1109/TIT.1978.1055934"><span itemprop="author">J. Ziv, A. Lempel</span>. <time datetime="1978" itemprop="datePublished">September 1978</time>. "<span itemprop="name">Compression of Individual Sequences via Variable-rate Coding</span>". <span itemprop="isPartOf" itemscope itemtype="https://schema.org/Periodical"><i itemprop="name">IEEE Transactions on Information Theory</i></span> 24 (5):530–36. <a itemprop="sameAs" href="https://doi.org/10.1109/TIT.1978.1055934">DOI</a>.</span></li>
            <li class="list-none my-4 mx-2"><span itemprop="citation" itemscope itemtype="https://schema.org/ScholarlyArticle" id="welchTechniqueHighPerformanceData1984" itemid="doi:10.1109/MC.1984.1659158"><span itemprop="author">Welch</span>. <time datetime="1984" itemprop="datePublished">June 1984</time>. "<span itemprop="name">A Technique for High-performance Data Compression</span>". <span itemprop="isPartOf" itemscope itemtype="https://schema.org/Periodical"><i itemprop="name">Computer</i></span> 17 (6):8–19. <a itemprop="sameAs" href="https://doi.org/10.1109/MC.1984.1659158">DOI</a>.</span></li>
            <li class="list-none my-4 mx-2"><span itemprop="citation" itemscope itemtype="https://schema.org/ScholarlyArticle" id="storerDataCompressionTextual1982" itemid="doi:10.1145/322344.322346"><span itemprop="author">James A. Storer, Thomas G. Szymanski</span>. <time datetime="1982" itemprop="datePublished">October 1982</time>. "<span itemprop="name">Data Compression via Textual Substitution</span>". <span itemprop="isPartOf" itemscope itemtype="https://schema.org/Periodical"><i itemprop="name">Journal of the ACM (JACM)</i></span> 29 (4):928–51. <a itemprop="sameAs" href="https://doi.org/10.1145/322344.322346">DOI</a>.</span></li>
          </ol>
        </div>
        <div class="bl-section">
          <h2>Links to this note</h2>
          <div class="backlinks">
            <ul>
              <li>
                <a href="/notes/complexity_metrics/">Complexity metrics</a>
              </li>
            </ul>
          </div>
        </div>
        <div class="text-center" style="font-variant-caps:all-small-caps">
          Last changed <a class="u-url" href="https://hugocisneros.com/notes/lempel_ziv_welch_algorithm/"><time itemprop="datePublished" class="dt-published" datetime="2021-05-04T09:22:00+0200">04/05/2021</time></a> | authored by <a href="https://hugocisneros.com/" rel="author" class="p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Hugo Cisneros</span></a>
        </div>
      </div>
    </article>
    <h3>Comments</h3>
    <script data-isso="https://comment.hugocisneros.com/" data-isso-require-author="true" data-isso-vote="true" src="https://comment.hugocisneros.com/js/embed.min.js"></script>
    <section id="isso-thread"></section><br>
    <a href="/notes#lempel_ziv_welch_algorithm"><b>← Back to Notes</b></a>
    <hr>
  </main>
  <footer class="footer container h-10 text-center">
    <ul class="pl-0">
      <li class="first:before:content-none before:content-['•'] inline-block list-none">
        <a class="rss-link inline-block text-neutral-800 dark:text-neutral-400 border-none" href="/blog/index.xml" type="application/rss+xml" target="_blank">Blog <img class="rss-icon w-4 inline-block" src="https://hugocisneros.com/img/RSS.svg" alt="RSS feed icon"></a>
      </li>
      <li class="ml-2 first:before:content-none before:content-['•'] inline-block list-none">
        <a class="ml-2 text-neutral-800 dark:text-neutral-400 border-none" href="https://github.com/hugcis/hugo-astatine-theme">Code</a>
      </li>
      <li class="ml-2 first:before:content-none before:content-['•'] text-neutral-800 dark:text-neutral-400 inline-block list-none"><span class="ml-2">© Hugo Cisneros 2022</span></li>
    </ul>
  </footer>
  <link rel="stylesheet" href="/js/katex/katex.min.css">
  <script src="/js/katex/katex.min.js"></script> 
  <script src="/js/katex/contrib/auto-render.min.js"></script> 
  <script>
  document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"\\[",right:"\\]",display:!0},{left:"\\begin{align}",right:"\\end{align}",display:!0},{left:"$$",right:"$$",display:!0},{left:"\\begin{equation}",right:"\\end{equation}",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1}]})})
  </script>
  <script data-goatcounter="https://stats.hugocisneros.com/count" async src="//stats.hugocisneros.com/count.js"></script>
</body>
</html>
